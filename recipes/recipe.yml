---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
# image will be published to ghcr.io/<user>/<name>
name: NeonTokyo4th-OS
description: The latest operation and maintenance system of the 4th Neon Tokyo City.

# the base image to build on top of (FROM) and the version tag to use
base-image: ghcr.io/ublue-os/kinoite-main
image-version: latest

modules:
  # Files Settings
  - type: files
    files:
      - source: system
        destination: /

  - type: brew
    nofile-limits: true
    brew-analytics: false

  - type: fonts
    fonts:
      nerd-fonts:
        - JetBrainsMono
      url-fonts:
        - name: MapleMonoNerdNFNormal
          url: https://github.com/subframe7536/maple-font/releases/download/v7.9/MapleMonoNormal-NF-unhinted.zip

  # Add Terra Packages
  - type: dnf
    install:
      packages:
        - terra-release
        - terra-release-extra

  # Install default tools in system and Remove some packages
  - type: dnf 
    repos:
      nonfree: rpmfusion
      copr:
        - dejan/lazygit
        - lihaohong/yazi
    install:
      allow-erasing: true
      skip-broken: true
      skip-unavailable: true
      packages:
        # --- Shell and Terminal ---
        - alacritty
        - fish
        # --- Terminal Tools ---
        - bat
        - zoxide
        - fastfetch
        - btop
        - htop
        - powertop
        - less
        - ripgrep
        - yazi
        - wl-clipboard
        - util-linux-user
        # --- Development ---
        - neovim
        - helix
        - code
        - zed
        - distrobox
        - podman-compose
        - gh
        - lazygit
        # --- Input ---
        - fcitx5
        - fcitx5-rime
        # --- Zip / Unzip ---
        - p7zip
        - p7zip-doc
        - p7zip-gui
        - p7zip-plugins
        - zstd
        - tar
        - zip
        - unzip
        # --- Useful Tools ---
        - clash-meta
        # --- System-Wide Tools ---
        - lm_sensors
        - collectd-sensors
        - ffmpeg
        - ImageMagick
        - podman
        # --- Fonts ---
        - google-noto-fonts-all
        - wqy-zenhei-fonts
        - fontawesome-fonts-all
    remove:
      packages:
        - firefox
        - firefox-langpacks

  - type: default-flatpaks
    configurations:
      - notify: true # Send notification after install/uninstall is finished (true/false)
        scope: system
        install:
          - com.google.Chrome
          - org.localsend.localsend_app
          - io.github.kukuruzka165.materialgram

  - type: systemd
    system:
      disabled:
        - flatpak-system-update.timer
      enabled:
        - clash-meta.service

  - type: os-release
    properties:
      NAME: NeonTokyo4thOS
      VERSION: Latest
      PRETTY_NAME: "NeonTokyo4th-OS"
      VARIANT: "General"
      VERIANT_ID: general

  - type: signing # this sets up the proper policy & signing files for signed images to work fully
